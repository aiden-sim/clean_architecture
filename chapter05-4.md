# 26장 메인(Main) 컴포넌트
### 서론
- 메인(main) 컴포넌트 : 나머지 컴포넌트를 생성하고, 조정하며, 관리하는 컴포넌트

### 궁극적인 세부사항
- 메인 컴포넌트는 가장 낮은 수준의 정책
- 메인은 모든 팩토리(Factory)와 전략(Strategy), 그리고 시스템 전반을 담당하는 나머지 기반 설비를 생성한 후, 시스템에서 더 높은 수준을 담당하는 부분으로 제어권을 넘기는 역할
- 메인을 통해서 의존성 주입이 이뤄져야 하고, 주입되고 나면 의존성 주입 프레임워크 없이 의존성을 분배할 수 있다.
- 가장 지저분한 컴포넌트

- 예제
  - 간단한 입력 명령어 해석 등은 main 함수에서 처리하지만, 명령어를 실제로 처리하는 일은 다른 **고수준 컴포넌트** 로 위임
  - 메인은 클린 아키텍처에서 가장 바깥 원에 위치하는, 지저분한 저수준 모듈
  - 메인은 고수준의 시스템을 위한 모든 것을 로드한 후, 제어권을 고수준의 시스템에게 넘긴다.
  
### 결론
- 초기 조건과 설정을 구성하고, 외부 자원을 모두 수집한 후, 제어권을 애플리케이션의 고수준 정책으로 넘기는 플러그인
- 메인을 여러개 둘 수 있음
  - ex) 개발용, 테스트용, 상용
  
# 27장 '크고 작은 모든' 서비스들
### 서론
- SOA와 MSA가 인기를 끌고 있는 이유
  - 서비스를 사용하면 상호 결합이 철저하게 분리되는 것처럼 보인다. (일부만 맞는말)
  - 서비스를 사용하면 개발과 배포 독립성을 지원하는 것처럼 보인다. (일부만 맞는말)
  
### 서비스 아키텍처?
- 서비스를 사용한다고 해서 아키텍처에 해당하는것은 아님
- 시스템 아키텍처는 의존성 규칙을 준수하며 고수준의 정책을 저수준의 세부사항으로부터 분리하는 경계에 의해 정의
  - 반면 서비스는 애플리케이션의 행위를 분리할 뿐인 서비스라면 값비싼 함수 호출에 불과
- 모든 서비스가 반드시 아키텍처 관점을 따라야 되는건 아니지만 기능을 독립적으로 서비스를 생성하면 의존성 규칙 준수 여부와 상관없이 큰 도움이 됨
- 함수들의 구성 형태도 비슷한데 모노리틱이나 컴포넌트 기반 시스템에서 아키텍처를 정의하는 요소는 의존성 규칙을 따르며 아키텍처 경계를 넘나드는 함수 호출들이다.
  - 반면 나머지 많은 함수들은 행위를 서로 분리할 뿐 (아키텍처적으로 중요하지 않음)
- 결론 : 서비스든 함수든 분리한다고 해서 다 아키텍처가 아니라 아키텍처 규칙과 경계를 지켜야 아키텍처 관점으로 중요하다.

### 서비스의 이점?
- 서비스를 까기 시작함

#### 결합 분리의 오류
- 서비스의 큰 이점은 서비스 사이의 결합이 확실히 분리됨
  - 반론
    - 하지만 프로세스 내의 또는 네트워크 상의 공유 자원 때문에 결합될 가능성이 여전히 존재
    - 서로 공유하는 데이터에 의해 이들 서비스는 강력하게 결합
    - 서비스 사이를 오가는 데이터 레코드에 새로운 필드가 추가된다면? 관련 서비스들 다 변경해 줘야 된다.
- 인터페이스가 잘 정의되어 있어야 한다.
  - 반론
    - 함수의 경우도 다르지 않다. 서비스라고 함수 인터페이스보다 더 잘 정의되는 것은 아니다.

#### 개발 및 배포 독립성의 오류
- 데브옵스 전략으로 전담팀에서 각 서비스를 작성, 유지보수, 운영을 책임질 수 있다. 이러한 개발 및 배포 독립성은 확장 가능한 것으로 간주된다.
  - 반론
    - 엔터프라이즈 시스템은 서비스 기반 외에도 모노리틱, 컴포넌트 기반 시스템으로도 구축할 수 있다.
    - 서비스라고 해서 항상 독립적으로 개발, 배포, 운영할 수 있는것은 아니다. (데이터나 행위에 결합되어 있다면 결합된 정도에 맞게 조정해야됨)
    
### 야옹이 문제
- 확장 가능 시스템을 구축하기 위해 수많은 작은 마이크로 서비스 기반으로 구축하기로 결정했고 개발팀을 소규모팀으로 세분화했음 
- ![example1](https://user-images.githubusercontent.com/7076334/100074476-236e7600-2e82-11eb-99b4-d239ad721b8f.png)
  - TaxiUI : 고객을 담당, 모바일 기기를 이용해 택시 호출
  - TaxiFinder : ㅇ
 
  


